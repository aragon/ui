{"version":3,"file":"TabsFullWidth.js","sources":["../../../../../src/components/Tabs/TabsFullWidth.js"],"sourcesContent":["import React, { useCallback, useRef, useState } from 'react'\nimport { Transition, animated } from 'react-spring'\nimport { useInside } from 'use-inside'\nimport { GU, textStyle, springs } from '../../style'\nimport { useFocusLeave } from '../../hooks'\nimport { IconDown } from '../../icons'\nimport { useTheme } from '../../theme'\nimport { KEY_ESC } from '../../utils'\nimport ButtonBase from '../ButtonBase/ButtonBase'\n\n// TabsFullWidth is an internal component\n/* eslint-disable react/prop-types */\n\nfunction TabsFullWidth({ items, selected, onChange }) {\n  const theme = useTheme()\n  const buttonRef = useRef(null)\n  const [insideSidePanel] = useInside('SidePanel')\n  const [opened, setOpened] = useState(false)\n\n  const selectedItem = items[selected]\n  const dropdownDisabled = items.length === 1\n\n  const close = useCallback(() => setOpened(false), [])\n\n  const focusButton = useCallback(() => {\n    if (buttonRef.current) {\n      buttonRef.current.focus()\n    }\n  }, [])\n\n  const toggle = useCallback(() => {\n    setOpened(opened => !opened)\n  }, [])\n\n  const change = useCallback(\n    index => {\n      close()\n      focusButton()\n      if (index !== selected) {\n        onChange(index)\n      }\n    },\n    [selected, onChange, close, focusButton]\n  )\n\n  const { handleFocusLeave, ref } = useFocusLeave(close)\n\n  // close on escape\n  const handleMenuKeyDown = useCallback(\n    event => {\n      if (event.keyCode === KEY_ESC) {\n        close()\n        focusButton()\n      }\n    },\n    [close, focusButton]\n  )\n\n  return (\n    <div\n      ref={ref}\n      onBlur={handleFocusLeave}\n      css={`\n        padding-bottom: ${2 * GU}px;\n      `}\n    >\n      <div\n        css={`\n          position: relative;\n          display: flex;\n          align-items: center;\n          justify-content: space-between;\n          width: 100%;\n          height: ${8 * GU}px;\n        `}\n      >\n        <ButtonBase\n          ref={buttonRef}\n          disabled={dropdownDisabled}\n          css={`\n            display: flex;\n            align-items: center;\n            justify-content: space-between;\n            width: 100%;\n            height: 100%;\n            background: ${theme.surface};\n            border-style: solid;\n            border-color: ${theme.border};\n            border-top-width: ${insideSidePanel ? '0' : '1px'};\n            border-bottom-width: 1px;\n            border-radius: 0;\n            ${textStyle('body2')};\n            &:active {\n              ${dropdownDisabled ? '' : `background: ${theme.surfacePressed};`}\n            }\n          `}\n          onClick={toggle}\n        >\n          <div\n            css={`\n              padding-left: ${2 * GU}px;\n            `}\n          >\n            {selectedItem}\n          </div>\n          <div\n            css={`\n              display: flex;\n              align-items: center;\n              justify-content: center;\n              width: ${7 * GU}px;\n              height: 100%;\n              color: ${theme.surfaceIcon};\n            `}\n          >\n            <IconDown\n              css={`\n                transition: transform 150ms ease-in-out;\n                transform: rotate3d(0, 0, 1, ${opened ? 180 : 0}deg);\n                color: ${dropdownDisabled ? theme.disabled : theme.surfaceIcon};\n              `}\n            />\n          </div>\n        </ButtonBase>\n        <Transition\n          items={opened}\n          config={springs.swift}\n          from={{ y: -1, opacity: 0 }}\n          enter={{ y: 0, opacity: 1 }}\n          leave={{ y: -1, opacity: 0 }}\n          native\n        >\n          {opened =>\n            opened &&\n            (({ opacity, y }) => (\n              <animated.div\n                css={`\n                  position: absolute;\n                  z-index: 9; // TODO: use <Root>\n                  top: ${8 * GU}px;\n                  left: 0;\n                  right: 0;\n                  border-bottom: 1px solid ${theme.border};\n                  box-shadow: 0px 2px 3px rgba(0, 0, 0, 0.05);\n                  background: ${theme.surface};\n                `}\n                style={{\n                  opacity: opacity,\n                  transform: y.interpolate(\n                    v => `translate3d(0, ${v * 4}px, 0)`\n                  ),\n                }}\n              >\n                <Menu\n                  items={items}\n                  onChange={change}\n                  onKeyDown={handleMenuKeyDown}\n                />\n              </animated.div>\n            ))\n          }\n        </Transition>\n      </div>\n    </div>\n  )\n}\n\nfunction Menu({ items, onChange, ...props }) {\n  const handleRef = useCallback(element => {\n    if (element) {\n      element.focus()\n    }\n  }, [])\n\n  return (\n    <div\n      ref={handleRef}\n      tabIndex=\"0\"\n      {...props}\n      css={`\n        display: flex;\n        flex-direction: column;\n        outline: 0;\n      `}\n    >\n      {items.map((item, index) => (\n        <MenuItem key={index} item={item} index={index} onChange={onChange} />\n      ))}\n    </div>\n  )\n}\n\nfunction MenuItem({ item, index, onChange }) {\n  const theme = useTheme()\n\n  const change = useCallback(() => {\n    onChange(index)\n  }, [onChange, index])\n\n  return (\n    <ButtonBase\n      onClick={change}\n      css={`\n        height: ${8 * GU}px;\n        padding-left: ${2 * GU}px;\n        text-align: left;\n        ${textStyle('body2')};\n        &:active {\n          background: ${theme.surfacePressed};\n        }\n      `}\n    >\n      {item}\n    </ButtonBase>\n  )\n}\n\nexport { TabsFullWidth }\n"],"names":["TabsFullWidth","items","selected","onChange","theme","useTheme","buttonRef","useRef","insideSidePanel","useInside","opened","setOpened","useState","selectedItem","dropdownDisabled","length","close","useCallback","focusButton","current","focus","toggle","change","index","handleFocusLeave","ref","useFocusLeave","handleMenuKeyDown","event","keyCode","KEY_ESC","GU","surface","border","textStyle","surfacePressed","surfaceIcon","disabled","springs","swift","y","opacity","transform","interpolate","v","Menu","props","handleRef","element","map","item","MenuItem"],"mappings":"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"}